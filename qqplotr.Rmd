---
title: ggplot2 compatible Quantile-quantile plots in R
author:
  - name: Alexandre Almeida
    affiliation: University of Campinas
    address:
    - Institute of Computing
    - Campinas, Brazil 13083-852
    email:  almeida.xan@gmail.com
  - name: Adam Loy
    affiliation: Affiliation
    address:
    - line 1
    - line 2
    email:  author2@work
  - name: Heike Hofmann
    affiliation: Iowa State University
    address:
    - Department of Statistics
    - Ames, IA 50011-1210
    email:  hofmann@iastate.edu
abstract: >
  An abstract of less than 150 words.
preamble: >
  % Any extra latex you need in the preamble
  \usepackage{nameref}
output: rticles::rjournal_article
---

## TODO:

* Abstract
* Intro
  + Review Q-Q plots and P-P plots, including other arrangements, and what is implemented in other packages
* Package implementation
* Give examples
    + Heike: BRFSS example
* Conclusion

## Introduction
\label{sec:introduction}

Univariate distributional assessment is a common thread throughout statistical analyses during both the exploratory and confirmatory stages. When we begin exploring a new data set we often consider the distribution of individual variables before moving on to explore multivariate relationships. After a model has been fit to a data set, we must assess whether the distributional assumptions made were reasonable, and if they are not we then must understand the impact this has on the conclusions. Graphics provide arguably the most common way to carry out these univariate assessments. While there are many graphical methods that can be used for distribution exploration and assessment, probability plotting is one of the most common graphical approaches used. 

Probability plotting refers to a family of methods based on the cumulative distribution function (CDF), most notably quantile (Q-Q) plots and probability (P-P) plots \citep{Wilk1968-ii}. In this paper, we focus on comparing an empirical distribution to a theoretical distribution. Let $Y_1, \ldots, Y_n$ denote a random sample from an unknown population, and let $\widehat{F}_y(q)$ be the empirical cumulative distribution obtained from the sample. Further, let $F(q)$ denote the CDF of a proposed dsitribution for the sample. A Q-Q plot is constructed by plotting the quantiles of the empirical distribution, $q_y(p) = F_y^{-1}(p)$, against the corresponding quantiles of the theoretical distribution, $q(p) = F^{-1}(p)$. This constuction is illustrated in Figure \ref{fig:qq}.
A P-P plot is constructed by plotting $F(q)$ against $\widehat{F}_y(q)$ for various quantiles, $q$. This constuction is illustrated in Figure \ref{fig:pp}. Regardless of the plot constructed, if the two distributions are identical, then the scatterplots will be linear with slope 1 and intercept 0. Additionally, Q-Q plots are invariant to linear transformations, so if two random variables differ by a linear transformation a Q-Q plot showing draws from their distributions will still be linear, but with a different slope and intercept, as seen in Figure \ref{fig:qq}. P-P plots, in turn, are sensitive to linear transformations.

```{r, message = FALSE, echo = FALSE, out.width = '.45\\linewidth', fig.width = 3.5, fig.height = 3.5, fig.show = 'hold', fig.align = 'center', fig.cap = "\\label{fig:qq}Illustrating what quantities are being plotted for Q-Q plots."}
require(ggplot2)
set.seed(3145)
rand_sample <- rnorm(30, mean = -1, sd = 1)
Fn <- ecdf(rand_sample)
defn_data <- data.frame(q = c(-5,4), rs = rand_sample)
ggplot(defn_data, aes(x = q)) +
  stat_function(fun = pnorm, n = 101, args = list(mean = 0, sd = 1)) +
  # stat_function(fun = pnorm, n = 101, args = list(mean = -1, sd = 1), linetype = 2) +
  stat_ecdf(mapping = aes(x = rs), geom = "step", linetype = 2) +
  geom_segment(aes(x = -5, y = .5, xend = qnorm(.5), yend = .5)) +
  geom_segment(aes(x = qnorm(.5), y = .5, xend = qnorm(.5), yend = 0)) +
  geom_segment(aes(x = quantile(Fn, .5), y = .5, xend = quantile(Fn, .5), yend = 0)) +
  scale_x_continuous(breaks = c(quantile(Fn, .5), qnorm(.5)), minor_breaks = NULL, labels = c(expression(q[y](p)), expression(q(p)))) +
  scale_y_continuous(breaks = c(0, .5, 1), minor_breaks = NULL, labels = c("0", "p", "1")) +
  theme_minimal() +
  ylab("Cumulative distribution function") +
  xlab("Quantiles")

require(qqplotr)
ggplot(data = defn_data, mapping = aes(sample = rs)) +
  stat_qq_point(dparams = list(mean = 0, sd = 1)) +
  theme_minimal() +
  ylab(expression(paste("Sample quantiles, ", q[y](p)))) +
  xlab(expression(paste("Theoretical quantiles, ", q(p))))
```

```{r, message = FALSE, echo = FALSE, out.width = '.45\\linewidth', fig.width = 3.5, fig.height = 3.5, fig.show = 'hold', fig.align = 'center', fig.cap = "\\label{fig:pp}Illustrating what quantities are being plotted for P-P plots."}
ggplot(defn_data, aes(x = q)) +
  stat_function(fun = pnorm, n = 101, args = list(mean = 0, sd = 1)) +
  # stat_function(fun = pnorm, n = 101, args = list(mean = -1, sd = 1), linetype = 2) +
  stat_ecdf(mapping = aes(x = rs), geom = "step", linetype = 2) +
  geom_segment(aes(x = -5, y = pnorm(-.5), xend = -.5, yend = pnorm(-.5))) +
  geom_segment(aes(x = -5, y = Fn(-.5), xend = -.5, yend = Fn(-.5))) +
  geom_segment(aes(x = -.5, y = 0, xend = -.5, yend = Fn(-.5))) +
  scale_x_continuous(breaks = -.5, minor_breaks = NULL, labels = "q") +
  scale_y_continuous(breaks = c(0, pnorm(-.5), Fn(-.5), 1), minor_breaks = NULL, labels = c("0", expression(F(q)), expression(hat(F)[y](q)), "1")) +
  theme_minimal() +
  ylab("Cumulative distribution function") +
  xlab("Quantiles")


ggplot(data = defn_data, mapping = aes(sample = rs)) +
  stat_pp_point(dparams = list(mean = 0, sd = 1)) +
  theme_minimal() +
  ylab(expression(paste("Cumulative probabilities, ", F(q)))) +
  xlab(expression(paste("Probability points, ", hat(F)[y](q))))

```

<!-- Figure \ref{fig:cdfs} displays two CDFs to illustrate the definition of Q-Q and P-P plots. Let $F_x(q)$ and $F_y(q)$ denote the two CDFs, and let $q_x(p) = F_x^{-1}(p)$ and $q_y(p) = F_y^{-1}(p)$ denote the quantile functions for each distribution. A Q-Q plot is constructed by plotting the $q_y(p)$ against $q_x(p)$ for various $p$. A P-P plot is constructed by plotting $F_x(q)$ against $F_y(q)$ for various quantiles, $q$. In practice, the distribution of a sample is often compared to a theoretical distribution. Here, the empirical CDF, $\widehat{F}_y$ is used in place of $F_y$. Regardless of the plot constructed, if the two distributions are the same, then the scattplots will be linear with slope 1 and intercept 0. Additionally, Q-Q plots are invariant to linear transformations, so if two random variables differ by a linear transformation a Q-Q plot showing draws from their distributions will still be linear, but with a different slope and intercept. P-P plots are sensitive to linear transformations. -->


While the basic form of both the Q-Q and P-P plots is a scatterplot, additional graphical elements are often added to aid in distributional assessment. For Q-Q plots, a reference line is often drawn through the points $(q(.25), q_y(.25))$ and $(q(.75), q_y(.75))$. For P-P plots a reference line with slope 1 and intercept 0 is used. In both plots, pointwise or simultaneous confidence bands are often added around the reference line to further aid in the visual assessment. 


Innovations to Q-Q and P-P plots have also been proposed. \citet{Loy2016-fg} discuss the creation of detrended Q-Q plots, where the $y$-axis is changed to show the difference between $q_y$ and the reference line. Consequently, the line representing the agreement with the theoretical distribution is the $x$-axis. \citet{Loy2016-fg} find that detrended Q-Q plots are more powerful than other designs, so long at the $y$-axis limits are set so that the aspect ratio is kept the same as in the traditional Q-Q plot. In reliability and survival analysis, probability plots often refer to a hybrid probability plot, there the CDF of the proposed theoretical distribution is plotted against the empirical order statistics, and transformations are applied to each axis to linearize the CDF \citep[cf.][chapter 6]{Meeker1998}. This hybrid probability plot is invariant to linear transformations.

```{r, echo=FALSE, out.width='.31\\linewidth', fig.width=3.5, fig.height=3.5, fig.show='hold', fig.align='center', fig.cap="\\label{fig:pp-designs}Illustrating different designs of probability plots."}
ggplot(data = defn_data, mapping = aes(sample = rs)) +
  stat_qq_line(dparams = list(mean = 0, sd = 1)) +
  stat_qq_point(dparams = list(mean = 0, sd = 1)) +
  ylab("Sample quantiles") +
  xlab("Theoretical quantiles") +
  ggtitle("Standard Q-Q plot") +
  theme_minimal()

ggplot(data = defn_data, mapping = aes(sample = rs)) +
  stat_qq_line(dparams = list(mean = 0, sd = 1), detrend = TRUE) +
  stat_qq_point(dparams = list(mean = 0, sd = 1), detrend = TRUE) +
  ylim(-diff(range(defn_data$rs))/2, diff(range(defn_data$rs))/2) +
  ylab("Differences") +
  xlab("Theoretical quantiles") +
  ggtitle("Adjusted detrended Q-Q plot") +
  theme_minimal()

defn_data$ppoints <- ppoints(defn_data$rs)
ggplot(data = defn_data, mapping = aes(x = sort(rs), y = ppoints)) +
  geom_point() +
  xlab("Sample quantiles") +
  ylab("Cumulative probabilty") +
  theme_minimal() +
  ggtitle("Hybrid probability plot")
```



Q-Q plots have been implemented in various forms in R, but none provide a complete implementation of
the probability plotting framework. Normal quantile plots, where a sample is compared to the
standard normal distribution, are implemented using the `qqplot` and `qqline` in \pkg{base} graphics
\citep{R}. `qqmath` in \pkg{lattice} provides a general framework for Q-Q plots, comparing a sample
to any theoretical distribution by specifying the quantile function \citep{lattice}. `qqPlot` in the
\pkg{car} package also allows for the assessment of non-normal distribution and adds pointwise
confidence bands based on the standard errors of the order statistics or the parametric bootstrap
\citep{car}. \pkg{ggplot2} provides `geom_qq` and `geom_qq_line`, enabling the creation of
traditional Q-Q plots with a reference line, much like those created using `qqmath`. \pkg{qqplotr}
extends \pkg{ggplot2} to provide the most complete implementation of probability plotting.

XXX `qualityTools` \cite{qualityTools}

In the remainder of this paper, we introduce the probability plotting framework provided by
\pkg{qqplotr}... FILL THIS IN ONCE OTHER SECTIONS ARE WRITTEN...


TODO: FIGURE OUT WHERE TO INTRODUCE TS BANDS \citep{Aldor-Noiman2013-xw}
TODO: FIGURE \ref{fig:pp-designs} HAS NO REFERENCES TO IT


## Implementing probability plots in the \pkg{ggplot2} framework

With \pkg{qqplotr} we extend some of the original \pkg{ggplot2} probability plot functionatilites by
permitting the drawing of Q-Q and P-P points, lines, and confidence bands. Our approach was to 
provide a \pkg{ggplot2} layering mechanism so that for each one of those plot elements we 
implemented a \pkg{ggplot2} "stat" (statistical transformation). In addition, we also implemented a 
\pkg{ggplot2} "geom" (geometrical object) specifically for the confidence bands. That geom permits a
simpler way of handling graphical parameters, which will become clearer in the 
\nameref{sec:examples} section.

For simplicity, the Q-Q and P-P functions will be presented separately below.

### Q-Q

The Q-Q plot functions are divided into three stats:

* `stat_qq_point`: a modified verion of `stat_qq` from \pkg{ggplot2} that plots the sample quantiles
versus the theoretical quantiles (as in Figure \ref{fig:qq}). The novelty of this implementation is 
an option to detrend the plotted points (see \nameref{sec:introduction}). All other implemented
functions in this package also allow the detrend adjustment.

* `stat_qq_line`: draws a reference line based on the sample data quantiles, defaulting to the first
and third quartiles.

* `stat_qq_band`: draws confidence bands based on three methods: *Normal*, *Bootstrap*, and
*Tail-sensitive*:
	+ **Normal**: constructs simultaneous confidence bands based on normal distribution confidence 
	intervals;
	+ **Bootstrap**: creates pointwise confidence bands using parametric boostrap;
	+ **Tail-sensitive**: builds tail-sensitive confidence bands, as proposed by
	\citet{Aldor-Noiman2013-xw}.

### P-P

The P-P plot functions are also divided into three plot elements:

* `stat_pp_point`: plots cumulative probabilities versus probability points (as in Figure
\ref{fig:pp}).

* `stat_pp_line`: draws a reference identity line (slope 1 and intercept 0).

* `stat_pp_band`: draws confidence bands. For now, only the *Bootstrap* version is available.

TODO:

* Talk more in-depth about the functions' parameters.

* P-P plot type II.

## Examples
\label{sec:examples}

In this section, we demonstrate the capabilities of the \pkg{qqplotr} package. We start by loading
the package:

```{r message=FALSE}
# also loads ggplot2
library(qqplotr)
```

### BRFSS example

The Center for Disease Control and Prevention runs an annual telephone survey, the Behavioral Risk Factor Surveillance System (BRFSS), to keep track of the US populations' 'health-related risk behaviors, chronic health conditions, and use of preventive services'.  

Close to half a million interviews are conducted each year. Here, we are focussing on the 2012 responses for Iowa. 7166 responses were gathered across 359 questions and derived variables. Among these, are people's height and weight, which we are going to assess in more detail. 

Figure \ref{fig:heights} shows two Q-Q plots side by side. For each of the plots, a sample of 200 men and 200 women is drawn from the overall number of responses. On the left hand side, individuals' heights are plotted in a Q-Q plot comparing raw heights to a normal distribution. We see that the distributions for both men and women (colour) is showing horizontal steps: this indicates that the distributional assessement is heavily dominated by the discreteness in the data, as most survey participants responded to the question of their height to the closest inch. On the right hand side of Figure \ref{fig:heights}, we use jittering; this means  that we add a random number generated from a random uniform distribution on $\pm 0.5$ inch to the reported height. By this mean we extinguish any effect that discreteness might have on the distribution. This brings the observed distribution much closer to a normal distribution. Note that separate normal distributions were fitted for each gender, not surprisingly, the resulting distributions have different means (women are on average 6 inch shorter than men in this dataset). Interestingly, the slope of the two genders is similar, indicating that the same scale parameter fits both genders' distributions (the standard deviation of height in the data set is 2.97 inch for men and 2.91 inch for women).

```{r heights, echo=FALSE, fig.width = 8, fig.height = 3.5, fig.cap = "Sample (200 men and 200 women) of raw heights (left) and jittered heights (right). The distribution on the left is dominated by the discreteness of the data. On the right we see that except for some outliers an assumption of normality for people's height is not completely absurd.", out.width='\\textwidth', fig.align="center", message=FALSE, warning = FALSE}
library(tidyverse)

iowa <- readRDS("data/brfss-iowa.rda")
set.seed(3145)
sub <- iowa %>% nest(-SEX) %>% mutate(
  data = data %>% purrr::map(.f = function(x) sample_n(x, size = 200))  
) %>% unnest(data) %>% dplyr::select(SEX, WTKG3, HTIN4) %>%
  mutate(Gender = c("Male", "Female")[SEX])

p1 <- sub %>% ggplot(aes(sample = HTIN4, colour=Gender, fill=Gender)) + 
  stat_qq_band(alpha = 0.3) + stat_qq_line() + stat_qq_point() +
  scale_fill_brewer(palette="Set1") +
  scale_colour_brewer(palette = "Set1") +
  xlab("Theoretical quantiles") +
  ylab("Height (in inch)") +
  coord_equal() +
  theme_bw() +
  theme(legend.position = c(0.8, 0.2), aspect.ratio = 1)

p2 <- sub %>% mutate(
  HTIN4.jitter = jitter(HTIN4, factor = 2)
) %>% ggplot(aes(sample = HTIN4.jitter, colour=Gender, fill=Gender)) + 
  stat_qq_band(alpha = 0.3) + stat_qq_line() + stat_qq_point() +
  scale_fill_brewer(palette="Set1") +
  scale_colour_brewer(palette = "Set1") +
  xlab("Theoretical quantiles") +
  ylab("Jittered Height (in inch)") +
  theme_bw() + 
  theme(legend.position = c(0.8, 0.2), aspect.ratio=1)
  
library(gridExtra)  
grid.arrange(p1, p2, ncol = 2)
```

Unlike respondents' heights, their weigths do not seem to be normally distributed. Figure \ref{fig:weights} shows again two Q-Q plots. The Q-Q plot on the left uses raw weights and compares to a normal distribution. From the curved points we see that tails of the observed distribution are heavier than expected under a normal distribution. On the right, weights are log-transformed. We see that a normal distribution for each of the genders shows --with the exceptions of a few extreme outliers-- a reasonable fit.

```{r weights, echo=FALSE, fig.width = 8, fig.height = 3.5, fig.cap = "Sample (200 men and 200 women) of weights. Unlike people's height, weight seems to be heavily right skewed with some additional outliers on the extreme left (left plot). On the right, weight was log-transfomed before its distribution is compared to a theoretical normal. ", out.width='\\textwidth', fig.align="center", message=FALSE, warning = FALSE}
p3 <- sub %>% ggplot(aes(sample = WTKG3/100, colour=Gender, fill=Gender)) + 
  stat_qq_band(alpha = 0.3) + stat_qq_line() + stat_qq_point() +
  scale_fill_brewer(palette="Set1") +
  scale_colour_brewer(palette = "Set1") +
  xlab("Theoretical quantiles") +
  ylab("Weight (in kg)") +
  coord_equal() +
  theme_bw() +
  theme(legend.position = c(0.8, 0.2), aspect.ratio = 1)

p5 <- sub %>% 
  ggplot(aes(sample = log(WTKG3/100), colour=Gender, fill=Gender)) + 
  stat_qq_band(alpha = 0.3) + stat_qq_line() + stat_qq_point() +
  scale_fill_brewer(palette="Set1") +
  scale_colour_brewer(palette = "Set1") +
  xlab("Theoretical quantiles") +
  ylab("log Weight (in kg)") +
  coord_equal() +
  theme_bw() +
  theme(legend.position = c(0.8, 0.2), aspect.ratio = 1)

# don't need the jittering
grid.arrange(p3, p5, ncol = 2)
```

Instead of transforming the observed values, we can change the theoretical distribution against which we compare. 
Figure \ref{fig:weights-log} shows two Q-Q plots where a a log-normal distribution is chosen as the theoretical distribution. On the left, we compare against a  log-normal distribution with mean 4.389 and standard deviation 0.223 (the log-transformed averages of average weight and standard deviation in Iowa's population). Again, the fits seem reasonable. 
On the right, parameters for the log-normal distribution are fit separately. The fits are slightly different from XXX

```{r weights-log, echo=FALSE, fig.width = 8, fig.height = 3.5, fig.cap = "Sample (200 men and 200 women) of weights. On the left, the theoretical distribution  is changed to a log normal. On the right, we additionally estimate shift and scale parameters for each of the genders separately before comparing distributions to a log-normal. XXX need to fix alpha for the legend", out.width='\\textwidth', fig.align="center", message=FALSE, warning = FALSE}

mlog <- mean(log(sub$WTKG3 / 100), na.rm = TRUE)
sdlog <- sd(log(sub$WTKG3 / 100), na.rm = TRUE)

p4 <- sub %>% ggplot(aes(sample = WTKG3 / 100, colour = Gender, fill = Gender)) +
  stat_qq_band(
    distribution = "lnorm",
    dparams = list(meanlog = mlog, sdlog = sdlog),
    alpha = 0.3
  ) +
  stat_qq_line(
    distribution = "lnorm",
    dparams = list(meanlog = mlog, sdlog = sdlog)
  ) +
  stat_qq_point(
    distribution = "lnorm",
    dparams = list(meanlog = mlog, sdlog = sdlog)
  ) +
  scale_fill_brewer(palette = "Set1") +
  scale_colour_brewer(palette = "Set1") +
  xlab("Theoretical quantiles") +
  ylab("Weight (in kg)") +
  theme_bw() + 
  theme(legend.position = c(0.2, 0.8), aspect.ratio=1)

p6 <- sub %>% ggplot(aes(sample = WTKG3 / 100, colour = Gender, fill = Gender)) +
  stat_qq_band(
    distribution = "lnorm",
    alpha = 0.3
  ) +
  stat_qq_line(
    distribution = "lnorm"
  ) +
  stat_qq_point(
    distribution = "lnorm"
  ) +
  scale_fill_brewer(palette = "Set1") +
  scale_colour_brewer(palette = "Set1") +
  xlab("Theoretical quantiles") +
  ylab("Weight (in kg)") +
  theme_bw() +
  theme(legend.position = c(0.2, 0.8),
  aspect.ratio = 1)

# layers <- sub %>% nest(-Gender) %>% mutate(
#   band = data %>% purrr::map(.f = function(d) {
#     mlog <- mean(log(d$WTKG3/100), na.rm=TRUE)
#     sdlog <- sd(log(d$WTKG3/100), na.rm=TRUE)
#     d$Gender <- c("Male", "Female")[d$SEX[1]]
#     geom_qq_band(alpha=0.4, distribution="lnorm",
#                        dparams=list(meanlog = mlog, sdlog = sdlog),
#                        aes(colour = Gender, fill = Gender), data = d)
#   }),
#   line = data %>% purrr::map(.f = function(d) {
#     mlog <- mean(log(d$WTKG3/100), na.rm=TRUE)
#     sdlog <- sd(log(d$WTKG3/100), na.rm=TRUE)
#     d$Gender <- c("Male", "Female")[d$SEX[1]]
#     stat_qq_line(distribution="lnorm",
#                       dparams=list(meanlog = mlog, sdlog = sdlog),
#                       aes(colour = Gender, sample=WTKG3/100), data = d)
#   }),
#   points = data %>% purrr::map(.f = function(d) {
#     mlog <- mean(log(d$WTKG3/100), na.rm=TRUE)
#     sdlog <- sd(log(d$WTKG3/100), na.rm=TRUE)
#     d$Gender <- c("Male", "Female")[d$SEX[1]]
#     qqplotr::stat_qq_point(alpha=1, distribution="lnorm",
#                       dparams=list(meanlog = mlog, sdlog = sdlog),
#                       aes(colour = Gender, sample=WTKG3/100), data = d)
#   })
# )
# 
# p6 <- sub %>% ggplot(aes(sample = WTKG3/100, colour = Gender, fill = Gender)) +
#   layers$band[[1]] + layers$band[[2]] +
#   layers$line[[1]] + layers$line[[2]] +
#   layers$points[[1]] + layers$points[[2]] +
#   theme_bw() +
#   scale_fill_brewer(palette="Set1") +
#   scale_colour_brewer(palette = "Set1") +
#   theme(legend.position=c(0.2, 0.8)) +
# 	xlab("Theoretical quantiles") +
# 	ylab("Weight (in kg)") +
#   guides(fill = guide_legend(override.aes = list(alpha = 0.3)))

grid.arrange(p4, p6, ncol = 2)
```

```{r table, echo=FALSE, results = 'asis'} 
tabs <- iowa %>% group_by(SEX) %>% summarize(
  mean_wt = mean(WTKG3 / 100, na.rm = TRUE),
  mean_log_wt = mean(log(WTKG3 / 100), na.rm = TRUE),
  sd_wt = sd(WTKG3 / 100, na.rm = TRUE),
  sd_log_wt = sd(log(WTKG3 / 100), na.rm = TRUE)#,
  # fitdistr = I(list(MASS::fitdistr(na.omit(WTKG3/100), "lognormal")))
  )

knitr::kable(tabs, format = "latex", caption = "this table is just for us at the moment")
```

### Using a non-standard distribution

ADAM: PULL DATA OFF EXTERNAL HARD DRIVE, EXPLAIN THE EXAMPLE...

The "standard" distributions provided in \pkg{stats} do not include a left-skewed distribution, which is clearly needed to model the long jump heights. To handle this type of situation, \pkg{qqplotr} let's users create probability plots for all of the  distributions defined in the \pkg{stats} package as well as other sources, so long as the distributions are defined following the conventions laid out in the \pkg{stats} package. Specfically, for some distribution there must be density/mass (`d` prefix), CDF (`p` prefix), quantile (`q` prefix), and simulation (`r` prefix) functions. 

To illustrate this process we will consider the Smallest Extreme Value (SEV) distribution. This is a left-skewed distribution, which is a key feature needed in order to model the long jump results. Below, we define the suite of distribution functions needed to utilize the SEV distribution.


```{r}
# CDF
psev <- function(q, mu, sigma) {
    z <- (q - mu) / sigma
    1 - exp(-exp(z))
}

# PDF
dsev <- function(x, mu, sigma) {
  z <- (x - mu) / sigma
  (1 / sigma) * exp(z - exp(z))
}

# Quantile function
qsev <- function(p, mu, sigma) {
  mu + log(-log(1 - p)) * sigma
}

# Simulation function
rsev <- function(n, mu, sigma) {
  qsev(runif(n), mu, sigma)
}
```






## Summary

Write this section once the rest of the paper is done.

\bibliography{RJreferences}

## Acknowledgements

Mention GSoC here...
